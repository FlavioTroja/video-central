!function(e){window.video_central_importMessages={loading:"Importing, please wait...",wait:"Not done yet, still importing. You'll have to wait a bit longer.",importing:"Importing",done:"Import Complete"},e(document).ready(function(){window.Video_Central_Import={init:function(){window.Video_Central_Import.Events(),window.Video_Central_Import.Wizard(),window.Video_Central_Import.Params_Ajax(),window.Video_Central_Import.Import_Ajax();var r=e(".wizard-wrap").attr("data-step");if(3==r){window.Video_Central_Import.Wizard_Step_Process(r-1,3);var t=e("#blocks").height(),o=e(".wp-list-table").height()+170;o>t&&e("#blocks").height(o)}},Events:function(){e("#video_central_feed").change(function(){var r=e(this).val(),t=e("#video_central_order").val();switch(e("label[for=video_central_query]").html(e(this).find("option:selected").attr("title")+" :"),r){case"query":e("tr.video_central_duration").show();var o=["position","commentCount","duration","reversedPosition","title"];e.each(o,function(r,t){e("#video_central_order option[value="+t+"]").attr({disabled:"disabled"}).css("display","none")}),e.each(["relevance","rating"],function(r,t){e("#video_central_order option[value="+t+"]").removeAttr("disabled").css("display","")});var a=e.inArray(t,o);-1!==a&&e("#video_central_order option[value="+o[a]+"]").removeAttr("selected");break;case"user":case"playlist":e("tr.video_central_duration").hide();var s=["relevance","rating"];e.each(s,function(r,t){e("#video_central_order option[value="+t+"]").attr({disabled:"disabled"}).css("display","none")}),e.each(["position","commentCount","duration","reversedPosition","title"],function(r,t){e("#video_central_order option[value="+t+"]").removeAttr("disabled").css("display","")});var n=e.inArray(t,s);-1!==n&&e("#video_central_order option[value="+s[n]+"]").removeAttr("selected")}}).trigger("change")},Wizard:function(){e("body").on("click",".progress_bar .step.complete",function(){var r=e(this).parent().find(".current").data("step"),t=e(this).data("step"),o="desc";r<t&&(o="asc"),window.Video_Central_Import.Wizard_Step_Process(r,t,o)})},Wizard_Move_to_Step:function(r,t,o,a){var s=25*(parseInt(r+1)-1);"asc"===o?(e("#step"+r).addClass("complete").removeClass("current"),e(".progress_bar").find(".current_steps").animate({width:s+"%"},a,function(){e("#step"+(r+1)).removeClass("complete").addClass("current"),r+1<t&&window.Video_Central_Import.Wizard_Move_to_Step(r+1,t,o,a)})):"desc"===o?(e("#step"+r).removeClass("complete").removeClass("current"),e(".progress_bar").find(".current_steps").animate({width:s+"%"},a,function(){e("#step"+(r-1)).removeClass("complete").addClass("current"),r-1>t&&window.Video_Central_Import.Wizard_Move_to_Step(r-1,t,o,a)})):(e("#step"+r).removeClass("complete").removeClass("current"),e(".progress_bar").find(".current_steps").animate({width:"0%"},a,function(){e("#step"+(r-1)).removeClass("complete").addClass("current"),r-1>t&&window.Video_Central_Import.Wizard_Move_to_Step(r-1,t,o,a)}))},Wizard_Step_Process:function(r,t,o){e("html, body").animate({scrollTop:0},"slow"),void 0===o&&(o="asc");var a="",s="";if("asc"===o?(a="-",s=""):"desc"===o&&(a="",s="-"),e("#block"+r).animate({left:a+"100%"},500,function(){e(this).css({left:"100%","z-index":"2"})}),e("#block"+t).css({"z-index":"3",left:s+"100%"}).animate({left:"0%"},500,function(){e(this).css({"z-index":"2"})}),1===Math.abs(r-t)){r<t?e("#step"+r).addClass("complete").removeClass("current"):e("#step"+r).removeClass("complete").removeClass("current");var n=25*(parseInt(t)-1);e(".progress_bar").find(".current_steps").animate({width:n+"%"},500,function(){e("#step"+t).removeClass("complete").addClass("current")})}else{var i=500/Math.abs(r-t);"restart"===o?window.Video_Central_Import.Wizard_Move_to_Step(r,t,"restart",i):r<t?window.Video_Central_Import.Wizard_Move_to_Step(r,t,"asc",i):window.Video_Central_Import.Wizard_Move_to_Step(r,t,"desc",i)}},Params_Ajax:function(){e("#video_central_load_feed_form").submit(function(r){""===e("#video_central_query").val()&&(r.preventDefault(),e("#video_central_query, label[for=video_central_query]").addClass("video_central_error"))}),e("#video_central_query").keyup(function(){""===e(this).val()?e("#video_central_query, label[for=video_central_query]").addClass("video_central_error"):e("#video_central_query, label[for=video_central_query]").removeClass("video_central_error")});e(".ajax-submit-params").on("click",function(r){""!==e("#video_central_query").val()?e(".import-global-loading").show().removeClass("video_central_error"):e("label[for=video_central_query]").addClass("video_central_error")})},Import_Ajax:function(){e(".ajax-submit .tablenav.top .actions select[name=action]").attr({name:"action_top"});var r=!1;e(".ajax-submit").submit(function(t){if(t.preventDefault(),r)return e(".video-central-ajax-response-task").html(window.video_central_importMessages.importing),void e(".video-central-ajax-response-progress").html(window.video_central_importMessages.wait);var o=e(this).serialize();r=!0,e(".video-central-ajax-response-progress").removeClass("success error").addClass("loading").html(window.video_central_importMessages.loading),e(".import-progress-inner").removeClass("success error done").addClass("loading");var a=setInterval(function(){new function(){e.ajax({type:"GET",url:window.ajaxurl,data:{action:"video_central_import_progress"},dataType:"JSON",beforeSend:function(){}}).done(function(r,t,o){var a=r;void 0===a.current&&(a.current=0),void 0===a.total&&(a.total=1);var s=Math.round(a.current/a.total*100);s=s||0,e(".video-central-ajax-response-progress").html(s+"%"),e(".import-progress-inner").removeClass("loading").css("width",s+"%")})}},5e3);e.ajax({type:"post",url:window.ajaxurl,data:o,dataType:"json",success:function(t){t.success&&(e(".video-central-ajax-response-progress").removeClass("loading error").addClass("success").html(t.success),e(".video-central-ajax-response-task").html(window.video_central_importMessages.done),e(".import-progress-inner").addClass("success done").css("width","100%")),t.error&&e(".video-central-ajax-response-progress").removeClass("loading success").addClass("error").html(t.error),clearInterval(a),r=!1}})})}},window.Video_Central_Import.init()})}(jQuery);